<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>spider-tool: taskqueue.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>taskqueue.h File Reference</h1>
<p>An API for managing task processing threads that can be shared across modules.  
<a href="#_details">More...</a></p>

<p><a href="taskqueue_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskqueue_8h.html#a3129ecb53ced5df45584e6b05278b93a">spd_tps_options</a> { <a class="el" href="taskqueue_8h.html#a3129ecb53ced5df45584e6b05278b93aae248d04bb7a6b5e0906e4906af4ee35a">TPS_REF_DEFAULT</a> =  0, 
<a class="el" href="taskqueue_8h.html#a3129ecb53ced5df45584e6b05278b93aabe990199e3796a0f60ff62ab1e36e3c0">TPS_REF_IF_EXISTS</a> =  (1&lt;&lt; 0)
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>spd_tps_options for specification of c options </p>
 <a href="taskqueue_8h.html#a3129ecb53ced5df45584e6b05278b93a">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct spd_taskqueue *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskqueue_8h.html#aa4930fff236a7e14a8e8921539d71b38">spd_taskqueue_get</a> (const char *name, enum <a class="el" href="taskqueue_8h.html#a3129ecb53ced5df45584e6b05278b93a">spd_tps_options</a> option)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a reference to a taskprocessor with the specified name and create the taskprocessor if necessary.  <a href="#aa4930fff236a7e14a8e8921539d71b38"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskqueue_8h.html#ac9bdba4f20061089a14c4558cb8c9a28">spd_taskqueue_unreference</a> (struct spd_taskqueue *tps)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unreference the specified taskprocessor and its reference count will decrement.  <a href="#ac9bdba4f20061089a14c4558cb8c9a28"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskqueue_8h.html#a2ba2932605e457d16543f37d7fbb18d4">spd_taskqueue_push</a> (struct spd_taskqueue *tps, int(*task_exe)(void *data), void *data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Push a task into the specified taskprocessor queue and signal the taskprocessor thread.  <a href="#a2ba2932605e457d16543f37d7fbb18d4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a21c0dbf24843d4520e99548b64a3b807"></a><!-- doxytag: member="taskqueue.h::spd_taskqueue_name" ref="a21c0dbf24843d4520e99548b64a3b807" args="(struct spd_taskqueue *tps)" -->
const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="taskqueue_8h.html#a21c0dbf24843d4520e99548b64a3b807">spd_taskqueue_name</a> (struct spd_taskqueue *tps)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the name of the taskprocessor singleton. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1c336fcf4eda0a99a43956bcab177ee6"></a><!-- doxytag: member="taskqueue.h::spd_taskqueue_init" ref="a1c336fcf4eda0a99a43956bcab177ee6" args="(void)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>spd_taskqueue_init</b> (void)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>An API for managing task processing threads that can be shared across modules. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>A taskqueue is a named singleton containing a processing thread and a task queue that serializes tasks pushed into it by [a] module(s) that reference the taskqueue. A taskqueue is created the first time its name is requested via the <a class="el" href="taskqueue_8h.html#aa4930fff236a7e14a8e8921539d71b38" title="Get a reference to a taskprocessor with the specified name and create the taskprocessor...">spd_taskqueue_get()</a> function and destroyed when the taskqueue reference count reaches zero.</dd></dl>
<p>Modules that obtain a reference to a taskqueue can queue tasks into the taskqueue to be processed by the singleton processing thread when the task is popped off the front of the queue. A task is a wrapper around a task-handling function pointer and a data pointer. It is the responsibility of the task handling function to free memory allocated for the task data pointer. A task is pushed into a taskqueue queue using the spd_taskqueue_push(taskqueue, taskhandler, taskdata) function and freed by the taskqueue after the task handling function returns. A module releases its reference to a taskqueue using the <a class="el" href="taskqueue_8h.html#ac9bdba4f20061089a14c4558cb8c9a28" title="Unreference the specified taskprocessor and its reference count will decrement.">spd_taskqueue_unreference()</a> function which may result in the destruction of the taskprocessor if the taskqueue's reference count reaches zero. Tasks waiting to be processed in the taskqueue queue when the taskqueue reference count reaches zero will be purged and released from the taskqueue queue without being processed. </p>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="a3129ecb53ced5df45584e6b05278b93a"></a><!-- doxytag: member="taskqueue.h::spd_tps_options" ref="a3129ecb53ced5df45584e6b05278b93a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="taskqueue_8h.html#a3129ecb53ced5df45584e6b05278b93a">spd_tps_options</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>spd_tps_options for specification of c options </p>
<p>Specify whether a v should be created via <a class="el" href="taskqueue_8h.html#aa4930fff236a7e14a8e8921539d71b38" title="Get a reference to a taskprocessor with the specified name and create the taskprocessor...">spd_taskqueue_get()</a> if the taskqueue does not already exist. The default behavior is to create a taskqueue if it does not already exist and provide its reference to the calling function. To only return a reference to a taskqueue if and only if it exists, use the TPS_REF_IF_EXISTS option in <a class="el" href="taskqueue_8h.html#aa4930fff236a7e14a8e8921539d71b38" title="Get a reference to a taskprocessor with the specified name and create the taskprocessor...">spd_taskqueue_get()</a>. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a3129ecb53ced5df45584e6b05278b93aae248d04bb7a6b5e0906e4906af4ee35a"></a><!-- doxytag: member="TPS_REF_DEFAULT" ref="a3129ecb53ced5df45584e6b05278b93aae248d04bb7a6b5e0906e4906af4ee35a" args="" -->TPS_REF_DEFAULT</em>&nbsp;</td><td>
<p>return a reference to a v, create one if it does not exist </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3129ecb53ced5df45584e6b05278b93aabe990199e3796a0f60ff62ab1e36e3c0"></a><!-- doxytag: member="TPS_REF_IF_EXISTS" ref="a3129ecb53ced5df45584e6b05278b93aabe990199e3796a0f60ff62ab1e36e3c0" args="" -->TPS_REF_IF_EXISTS</em>&nbsp;</td><td>
<p>return a reference to a taskqueue ONLY if it already exists </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa4930fff236a7e14a8e8921539d71b38"></a><!-- doxytag: member="taskqueue.h::spd_taskqueue_get" ref="aa4930fff236a7e14a8e8921539d71b38" args="(const char *name, enum spd_tps_options option)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct spd_taskqueue* spd_taskqueue_get </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="taskqueue_8h.html#a3129ecb53ced5df45584e6b05278b93a">spd_tps_options</a>&nbsp;</td>
          <td class="paramname"> <em>option</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get a reference to a taskprocessor with the specified name and create the taskprocessor if necessary. </p>
<p>The default behavior of instantiating a taskprocessor if one does not already exist can be disabled by specifying the TPS_REF_IF_EXISTS spd_tps_options as the second argument to spd_taskprocessor_get(). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>The name of the taskprocessor </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>create</em>&nbsp;</td><td>Use 0 by default or specify TPS_REF_IF_EXISTS to return NULL if the taskprocessor does not already exist return A pointer to a reference counted taskprocessor under normal conditions, or NULL if the TPS_REF_IF_EXISTS reference type is specified and the taskprocessor does not exist </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2ba2932605e457d16543f37d7fbb18d4"></a><!-- doxytag: member="taskqueue.h::spd_taskqueue_push" ref="a2ba2932605e457d16543f37d7fbb18d4" args="(struct spd_taskqueue *tps, int(*task_exe)(void *data), void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spd_taskqueue_push </td>
          <td>(</td>
          <td class="paramtype">struct spd_taskqueue *&nbsp;</td>
          <td class="paramname"> <em>tps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *data)&nbsp;</td>
          <td class="paramname"> <em>task_exe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Push a task into the specified taskprocessor queue and signal the taskprocessor thread. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tps</em>&nbsp;</td><td>The taskprocessor structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>task_exe</em>&nbsp;</td><td>The task handling function to push into the taskprocessor queue </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>datap</em>&nbsp;</td><td>The data to be used by the task handling function </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

</div>
</div>
<a class="anchor" id="ac9bdba4f20061089a14c4558cb8c9a28"></a><!-- doxytag: member="taskqueue.h::spd_taskqueue_unreference" ref="ac9bdba4f20061089a14c4558cb8c9a28" args="(struct spd_taskqueue *tps)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* spd_taskqueue_unreference </td>
          <td>(</td>
          <td class="paramtype">struct spd_taskqueue *&nbsp;</td>
          <td class="paramname"> <em>tps</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unreference the specified taskprocessor and its reference count will decrement. </p>
<p>Taskprocessors use obj and will unlink from the taskprocessor singleton container and destroy themself when the taskprocessor reference count reaches zero. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tps</em>&nbsp;</td><td>taskprocessor to unreference </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>NULL </dd></dl>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated on Wed Jan 18 13:13:30 2012 for spider-tool by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
